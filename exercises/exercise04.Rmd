---
title: "Exercise 4"
author: "Philipp Drebes"
date: "`r format(Sys.Date(), '%d.%m.%Y')`"
output: 
  pdf_document: 
    keep_tex: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Exercise 4.1

In this exercise, we would like to investigate the properties of an AR(1) process.

a)  Simulate a realization of the process $X_t = 0.8 · X_{t−1} + e_t$ with $e_t$ an innovation process of length 1000.

```{r}
set.seed(999)
sim.d <- arima.sim(list(ar = c(0.8)), n = 1000)
plot(sim.d)
```

b)  Calculate the theoretical autocorrelation function and the plug-in estimator of the autocorrelation of the simulation results in a) and plot both curves for lags from 0 to 100.

```{r}
theo.acf <- ARMAacf(ar = c(0.8), lag.max = 100)
plot(theo.acf)

acf(sim.d)
```

c)  What is the functional dependence of the theoretical autocorrelation function on the lag $k$ and $\alpha_1 = 0.8$?

## TODO

d)  Now compare the theoretical partial autocorrelation function with the estimated version for the simulated process. Which particularity do you observe for the two representations?

```{r}
theo.pacf <- ARMAacf(ar = c(0.8), lag.max = 100, pacf = TRUE)
plot(theo.pacf)

pacf(sim.d)
```

## Exercise 4.2

An analytic device measures the creatine concentration of human muscular tissue. In this exercise, we would like to check whether it is operating correctly, i.e. the measured values does not depend on the measuring instance.

A sample with known concentration is split into 157 samples and measured by the device one after the other. You can find them in the data under <http://stat.ethz.ch/Teaching/Datasets/WBL/kreatin.dat>

In this exercise, we focus only on the variable "gehalt" (content) in the data.

```{r}
creatine <- read.csv('http://stat.ethz.ch/Teaching/Datasets/WBL/kreatin.dat', sep = ' ')
creatine.ts <- ts(creatine$gehalt)
plot(creatine.ts)
```

a)  Which stochastic model should this series of data follow if the machine is working correctly?

It should be an AR model, because... \## TODO

b)  Use the time series plot, the autocorrelations (and the partial autocorrelations) to determine whether these data fit the ideal model found in Part a) or not.

```{r}
acf(creatine.ts)
pacf(creatine.ts)
```

## Exercise 4.3

In this exercise, we consider two time series ts1 and ts2, which putatively were created by an AR process. You may download the data from <http://stat.ethz.ch/Teaching/Datasets/WBL/ts_S3_A2.dat>

```{r}
data <- read.csv('http://stat.ethz.ch/Teaching/Datasets/WBL/ts_S3_A2.dat', sep = ' ')
data.ts1 <- ts(data$ts1)
data.ts2 <- ts(data$ts2)
```

a)  Visualize both time series. Are both time series stationary? What is their mean?

```{r}
plot(data.ts1)
acf(data.ts1)
plot(data.ts2)
acf(data.ts2)
```

b)  Consider the (partial) autocorrelation function and decide whether the two time series can be generated by an AR process. If yes, what is the order of the respective AR process?

Hint: The partial auto correlation function of an AR(p) process displays a sudden drop for lags larger than $p$.

```{r}
pacf(data.ts1)
pacf(data.ts2)
```
